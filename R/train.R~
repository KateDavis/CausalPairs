require(caret)

source("data_io.R")
source("features.R")

train <- read_train_pairs()



classifier <- ddply(train, .(sampleid), summarise,
                    A_sampsize = length(A),
                    B_sampsize = length(B),
                    A_uniq_samp_size = count_unique(A),
                    B_uniq_samp_size = count_unique(B),
                    A_norm_entropy = normalized_entropy(A),
                    B_norm_entropy = normalized_entropy(B),
                    pearson_R = cor(A, B),
                    pearson_R_magnit = correlation_magnitude(A, B),
                    entropy_diff =  entropy_difference(A, B)
                    )



target <- read_train_target()[,2]

set.seed(1)
classifierFit <- randomForest(x = classifier,
                              y = target,
                              ntree = 50,
                              mtry = 10,
                              )


save_model(classifierFit)
