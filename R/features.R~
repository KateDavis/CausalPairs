## setRefClass("FeatureMapper",
##             fields = list(features = "matrix"),
##             methods = list(
##             fit <- function(.Object, X, y = NULL) {
##             },
##             transform <- function(.Object, X) {
##                 extracted <- list()
##             },
##             fit_transform <- function(.Object, X, y = NULL) {
##             })
##             )


count_unique <- function(x) length(unique(x))

normalized_entropy <- function(x) {
    x <- sort(scale(x))
    delta <- diff(x)
    hx <- sum(log(abs(delta[which(delta != 0)])))
    hx / (length(x) - 1) + psigamma(length(x)) - psigamma(1)
}

entropy_difference <- function(x, y)
    normalized_entropy(x) - normalized_entropy(y)

correlation_magnitude <- function(x, y, ...)
    abs(cor(x, y, ...))

## setRefClass("SimpleTransform",
##             fields = list(transformer = "function"),
##             methods = list(
##             fit <- function(.Object, X, y = NULL) {
##             },
##             transform <- function(.Object, X) {
##                 extracted <- list()
##             },
##             fit_transform <- function(.Object, X, y = NULL) {
##             })
##             )

## setRefClass("MultiColumnTransform",
##             fields = list(transformer = "function"),
##             methods = list(
##             fit <- function(.Object, X, y = NULL) {
##             },
##             transform <- function(.Object, X) {
##                 extracted <- list()
##             },
##             fit_transform <- function(.Object, X, y = NULL) {
##             })
##             )
